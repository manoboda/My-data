---
title: "forestfires"
author: "Mano"
date: "2022-10-04"
output: word_document
---
## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
#install.packages("GGally")
library(GGally)
library(tidyverse)
```


```{r}
setwd('C:/Users/kiran/Documents/GitHub/My-data') #reading file from local drive
df = read.delim('forestfires.tsv', header = TRUE, sep = '\t')
head(df)
df$month <- as.factor(df$month) #changing into factors
df$day <- as.factor(df$day) #changing into factors
summary(df)
df$area %>% summary()
```



```{r }

levels(df$month) # to verify level and order
levels(df$day)
#average burn area recorded is 12.85
#modifying the order to plot 
df$month = factor(df$month, 
                  levels = c('jan','feb' ,'mar', 'apr', 'may' , 'jun', 'jul' , 'aug', 'sep' ,'oct', 'nov', 'dec'))

df$day = factor(df$day, 
                levels = c('sun','mon','tue', 'wed', 'thu', 'fri', 'sat'))
levels(df$day)

burn_day = 
  df %>% 
    group_by(day) %>%
    summarize(area_mean1 = mean(area))

df2 <- burn_day %>% select(day, area_mean1)
df2
#per day plot
ggplot(burn_day) +
  geom_bar(mapping = aes(x =day, y = area_mean1) , stat = "identity") +
   
   ggtitle(label = "Summarized by weekdays") +
   labs( y = "Area mean by day", x = "weekday")
 


  
#plot for overall with log scale for better data review for reviewing cause vs correlation 
df %>% ggplot() +
  geom_bar(mapping = aes(x = day, y = area + 1) , stat = "identity") +
  facet_wrap(~ month) +
  scale_y_log10() +
  ggtitle(label = "Summarized by month",
          subtitle = "using facet wrap by month") +
  labs( y = "Log area", x = "weekday")
  

  

  
```
Looking at plots, it seems Saturday may have more burn area. Reviewing the overall data month wise, shows that Saturday and Sundays in August and September may have more burn area. This may be that there are more visitors in weekend, which may cause more forest burn area. 


```{r }
df_rain <- df %>% filter(df$rain>0) 
print("summary of area with rain")  
df_rain %>% summary()
nrow(df_rain)


#plot of Burn area with rain


ggplot(df_rain,aes(x = rain, y = area + 1))  +  # plotting burn area vs. relative humidity
  geom_point() +  # scatter plot
  geom_jitter() +
  scale_y_log10() +
  geom_smooth(method = "lm", se = TRUE)  + # add linear trendline 
  ggtitle(label = "Burn area with rain", nrow(df_rain)) +
  labs( y = "log area")
```
Plot and summary table shows that the burn area increase with rain,
#next chunk is to identify what factors may have impacted this corrleation. 

```{r }
#plot of burn area with rain with factors of  humidity, wind & temp

ggplot(df_rain,aes(x = RH, y = area + 1))  +  # plotting burn area vs. FFMC
  geom_point(size = df_rain$rain) +  # scatter plot
  geom_jitter() +
  geom_smooth(method = "lm", se = TRUE)  + # add linear trendline 
  ggtitle(label = "Burn Area with RH", nrow(df_rain)) +
  scale_y_log10() +
  labs( y = "log area")

ggplot(df_rain,aes(x = temp, y = area +1))  +  # plotting burn area vs. DMC
  geom_point(size = df_rain$rain) +  # scatter plot
  geom_jitter() +
  geom_smooth(method = "lm", se = TRUE)  + # add linear trendline 
  #facet_grid(day~month) + 
  ggtitle(label = "Burn Area with temp", nrow(df_rain))+
  scale_y_log10() +
  labs( y = "log area")

ggplot(df_rain,aes(x = wind, y = area + 1))  +  # plotting burn area vs. DC
  geom_point(size = df_rain$rain) +  # scatter plot
  geom_jitter() +
  geom_smooth(method = "lm", se = TRUE)  + # add linear trendline 
  #facet_grid(day~month) + 
  ggtitle(label = "Burn Area with wind", nrow(df_rain)) +
  scale_y_log10() +
  labs( y = "log area")




#ggpairs with temp, RH, wind , rain to understand any correlation with rain with other factors
ggpairs(select(df_rain, temp, RH, wind, rain), mapping = aes(alpha =0.5)) +
  ggtitle(label ="ggpairs for temp, wind , RH and rain ")

#ggpairs with idex
ggpairs(select(df_rain, FFMC, DMC, DC, ISI, rain), mapping = aes(alpha =0.5)) +
  ggtitle(label ="ggpairs for FFMC,DC, DMC , ISI and rain ")

```

Plot and summary table shows that the burn area increase with rain, In theory, burn area should be less with rain. This may be effect of other factors.Next step was more analysis. The plot between temp & burn area with rain, shows increasing while humidity vs burn area shows decreasing trend. Similar correlation can be seen using ggpairs.  strong (positive) correlation with rain & temp and moderate correlation (negative) with RH. Temperature and humidity may have effected the burn area.  Temp & humidity can effect the indices . hence ggpairs with indices also show correlation. 





```{r}
df_zeroburn <- df %>% filter(df$area == 0) #zero burn area has negligible burn area but fires were recorded. 
df_zeroburn %>% summary()
ggplot(df_zeroburn, aes(x = month)) +
  geom_bar() +
  ggtitle(label = " Plot of month vs zero burn area")


```
plot and data summary shows that august month has most recorded days with zero burn area, followed by September


 Create a “heat map” that shows the maximum burn area for each X/Y coordinate, for days where the wind was above average.
```{r}
df$wind %>% summary()
#average wind is 4.08 from table 


 
df_heatmap =
  df %>%
    filter(wind > 4.08) %>% #filtered wind values > average value of 4.08
    group_by(X , Y) %>%
    summarize(area_max = max(area))

df_heatmap
#heat map
ggplot(df_heatmap, aes(x = factor(X), y = factor(Y), fill = area_max)) +  # 3-dimensional data, with the area_mean (3rd variable) being used for the fill
  geom_tile() +  # 2-dimensional 'heat-map'
  scale_fill_gradient2() + # gradient fill, corresponding to area_mean
   ggtitle(label = "Heat map") +
   labs(y = "y coordinate" , x ="x coordinate")



```
it shows that coordinates with x=8, y= 6 has most burn area with wind speed greater than average. most of the heat map shows lesser burn area almost 0 to <200. There are some coordinates with 200 to 400 burn area.  


Create a ggpairs plot that shows the relationships between wind, temperature and log_area, only for the days when it didn’t rain.
```{r}

df$log_area = log10(df$area + 1)

df_worain <-df %>% filter(df$rain == 0) %>% select(wind, temp,log_area, day)


ggpairs(select(df_worain, wind, temp, log_area, day),mapping = aes(color = day, alpha = 0.5)) +
  ggtitle(label = "ggpairs with  wind, temp and log_area color as day")


ggpairs(select(df_worain, wind, temp, log_area, day),mapping = aes (alpha = 0.5)) +
   ggtitle(label = "ggpairs for wind, temp, log_area and day")




```
1st & 2nd plot are same. However 1st seemed more confusing with days. So using 2nd plot for this. 2nd plot with ggpair with all 4 included, shows interesting trend. The correlation of log_area to wind is 0.076, whie log_area to temp is 0.050, which indicates very low correlation. There may be a relativley mediucm negative correlation of temp to wind at -0.234. 